# NLSR: 命名数据链路状态路由协议

> paper地址：[NLSR: Named-data Link State Routing Protocol](https://named-data.net/wp-content/uploads/2013/07/nlsr-final.pdf)

## 摘要（Abstract）

本文介绍了一种用于命名数据网络（NDN， *Named Data Network*）的路由协议——命名数据链路状态路由协议（NLSR，*Named-data Link State Routing Protocol*）的设计。由于NDN使用名称来标识和检索数据，所以NLSR将可达性传播到名称前缀而不是IP前缀。此外，NLSR区别于基于IP的链路状态路由协议，有两个最基本的特征。首先，NLSR使用兴趣包（*Interest Packet*）和数据包（*Data Packet*）来传播路由更新，直接受益于NDN内生的数据包验证，更加安全；其次，NLSR为每一个名称前缀生成一个按**一定规则**（*比如，开销*）排好序的转发选项列表，给实现NDN自适应的转发策略做支撑。在本文中，我们将讨论NLSR主要设计思想，主要包括以下几个部分：

- 一个适用于路由器、安全密码（*keys，包括公私钥那些*）、和路由更新的层次化命名方案；

- 一个适用于单个管理域的层次化信任模型；
- 一个逐条同步协议，用于替代传统的使用网络泛洪的方式传播路由更新；
- 一个给多路径转发选项排序的简单算法。

与基于IP的链路状态路由协议相比，NLSR提供更高效的路由更新传播，拥有内建的路由更新认证而且原生支持多路径转发。

## 关键词（Keywords）

Routing, NDN, Trust Model

## 介绍（Introduction）

命名数据网络（NDN）[3, 4]是一种新型的网络体系结构，是对当前基于IP的Internet体系结构一次大刀阔斧的整改。NDN在每个包（*packet*）中都放置一个数据名称，而不是携带目标IP地址；数据的消费者发送一个兴趣包（*Interest packet*）来获取数据，兴趣包中包含了所要获取数据的名称标识，一个包含相同名字的数据包（*Data packet*）可以用来响应这个兴趣包（*Interest Packet*），数据包中包含名称、数据以及一个由最初的数据生产者生成的对该数据包的签名。通过给数据包进行显示的命名和签名，NDN网络支持一系列的特性，包括：网内缓存（ *in-network caching*）、多路径转发（*multipath forwarding*）、多播数据交付（*multicast data delivery*）和数据真实性校验（*data authenticity*）。

为了能使NDN在广域网（*wide-area networks*）上能很好的工作，一个NDN的路由协议需要计算并将合适的转发条目插入到NDN节点的FIB（*NDN网络的转发表*）表中。每个FIB表项包含一个名称前缀和一个或多个下一条出口记录，NDN可以根据FIB表信息来转发和FIB表项中名称前缀相匹配的兴趣包（*Interest packet*）。IP网络下的路由协议必须使用单一的最佳下一跳或者限制其转发到多个等成本的路径，来避免循环路径的产生，而NDN网络有内建的预防循环路径产生的机制，所以可以自由的利用多个路径。因此，**NDN网络需要一个能够支持基于名称进行多路径路由的路由协议**。

我们之前为NDN开发了一个**OSPFN** [8] 路由协议，它是OSPF路由协议的一个扩展版本，适用于NDN，并将其部署在NDN的测试床上。OSPFN定义了一种新的不透明的链路状态通告（LSA），用于在路由消息中携带名称前缀。它为每个名称前缀计算出最佳的下一跳，并插入到FIB表当中，网络管理员可以手动为OSPFN配置一个除了最佳下一跳以外的可选下一跳列表，并插入到FIB表中。虽然OSPFN可以构建基于名称前缀的FIB表，但同样存在很多限制。和传统的基于IP的路由协议一样，OSPFN仍然使用IP地址作为路由器的ID，依赖于GRE隧道来跨越传统的IP网络，并且对于每个名称前缀值计算一个最佳的下一跳。我们在部署OSPFN的过程中发现，管理IP地址和隧道是主要的操作问题，并且由于对多路径的支持不够，限制了NDN原有的优势（*内建的网内缓存和防路径循环机制等等*）。

在本文接下来的部分，我们将介绍命名数据链路状态路由协议（NLSR）的详细设计，并使其工作在NDN网络上（**换句话来说，NLSR使用NDN的兴趣包和数据包来交换路由消息**）。OSPFN是一种与OSPF类似的链路状态协议——链路状态通告（LSA）在整个网络中传播，每个路由器构建出了完整的网络拓扑。和OSPF有所区别的是，在OSPFN中，路由器不再只计算一条最短路径，而是对所有符合策略的下一跳进行排名，并按序写入FIB表当中，其在本质上提供了一个基于名称的多路径路由表，被用来作为NDN转发策略的输入（*NDN的可以利用多路径信息进行丰富的转发策略定制*）。

NLSR使用名称而不是IP地址来标识路由器和链接，因此它可以使用任何底层的通信渠道（*例如：以太网、IP隧道、TCP/UDP隧道等等*）来交换路由消息。**NLSR直接受益于NDN内建的数据认证机制**：由于每个路由更新消息都是由NDN数据包（*Data packet*）所携带的，并且NDN中每个数据包都带有数据生产者的签名，所以路由器可以通过验证每个路由消息的签名来保证它是由指定的原始路由器生成的，并且在传播过程中没有被篡改（***数据的完整性和有效性校验***）。

作为NDN上第一个分布式的路由协议，NLSR的设计需要回答以下几个在NDN上独有的问题：

- **命名**（*Naming*）：如何给**路由器**（*routers*）、**链接**（*links*）和**路由更新**（*routing updates*）命名？
- **信任**（*Trust*）：如何**分发路由器的加密密钥**（*cryptographic keys*），以及如何获得对这些密钥的信任
- **信息传播**（*Information Dissemination*）：如何**在网络中传播路由更新**？（*基于IP的路由协议采用推的方式将路由更新发送给其他路由器，而在NDN网络中则需要路由器主动去拉取所有更新*）
- **多路径**（*Multipath*）：如何产生并排序下一跳以促进多跳转发？

在本文中，我们描述了我们是如何选择我们的设计方案的，并且阐明了这些选择背后的基本原理。我们的目标不是发明一种新的路由方案（*因为在本质上来讲NLSR也是一种链路状态路由协议*），而是为了证明在NDN网络上建立一个路由协议的可行性和优势。

由于NDN的自适应多路径转发能够处理在转发平面上存在的多个数据包传递问题（*例如：环形路径*），使得路由平面的限制放宽了，设计可以更加自由。举例来说，路由协议将不用关心路由平面是否会产生环路，因为NDN的FIB表项的合并操作将使得环路的产生变得不可能。因此，一些原先在IP网络中不起作用的路由协议设计现在可以在NDN网络中使用，并且新型路由的设计也成为可能。探索其它类型的路由设计将是我们未来的工作之一。

本文接下来的部分将包含以下内容：第二节简要介绍了NDN网络所提供的一些基本的功能，第三节介绍了设计的细节，第四节展示了实验测量和结果，第五节讨论一些相关的工作，第六节将对全文进行总结。

## NDN的基本功能（NDN PRIMARY）

NDN在其转发平面 [3] 中有三个主要的组件：

- **转发信息库**（FIB，*Forwarding Information Base*）：FIB即为NDN网络中的转发表，用于存储转发条目，将兴趣包与**相匹配数据**（*与兴趣包名称相同的数据包*）的潜在来源相关联。与IP网络中的转发表不同的是，对于每一个名称前缀，他的传出端口（下一跳）不止一个，而是一个列表。FIB表中的表项可以手动插入，也可以利用NDN路由协议中的控制平面进行填充。
- **未决兴趣表**（PIT，*Pending Interest Table* ）：PIT表存储了未被满足的兴趣包以及他们到来的face接口，因此数据包可以通过查询PIT表项被路由回到原始的发送兴趣包的节点。
- **内容缓存**（CS，*Content Store*）：CS用来缓存数据。

当一个兴趣包到达路由器，路由器首先会检查`CS`中是否有相匹配的数据，如果有则将数据包从收到兴趣包的端口上转发出去，否则将其添加到PIT表当中（*同时记录下兴趣包的入口Face*）。如果PIT表中存在相同名称的条目，新的端口编号将被添加到端口列表当中，以便可以在数据包到来时向所有兴趣包到来的端口发送一个数据包的副本。最后，如果兴趣包是第一次插入PIT表中（*即 PIT表中不存在相同名字的兴趣包*），则该兴趣包将通过查询FIB表转发至下一跳，如果FIB条目中存在多个下一跳，则一个成为“转发策略”的模块将会决定在多条路径同时存在的情况下，该如何转发兴趣包。

## 设计（Design）

作为一种链路状态路由协议，NLSR通过分发链路状态通告（LSAs）来构建网络拓扑并分发名称前缀可达性。NLSR路由器建立并维护与邻接路由器的关系，每当它检测到任意链接的故障或恢复，或者是发现一个新的邻居，都会生成一个新的LSA并传播到整个网络当中。此外，NLSR路由器还会向全网通告本地静态配置的名称前缀和local的内容提供者动态注册的前缀。当任意的名称前缀被添加或者删除时，NLSR同样会生成一个新的LSA并将其传播到全网。最新版本的LSAs将会存储在链路状态数据库（LSDB，*Link State Data Base*）。

这种拓扑和可达性信息的分发方式最初看起来似乎有点过于直接了，因为在IP路由器中已经实现了类似的功能。然后，由于在NLSR中使用NDN的兴趣包和数据包来进行路由更新，路由协议的设计就必须对IP地址和IP数据推送等一些熟悉的概念（*例如：在IP网络中任何节点都可以简单的将任何数据包发送到任何其它的节点*）做一些转变。因此，我们需要根据数据的名称和数据的获取方式来思考我们的设计。更具体来说，我们需要一个针对路由器和路由更新的系统的命名方案（*3.1节详细介绍*）。

